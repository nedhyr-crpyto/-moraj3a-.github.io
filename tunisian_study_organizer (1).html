<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منظم الدراسة - Study Organizer</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --warning-gradient: linear-gradient(135deg, #fceabb 0%, #f8b500 100%);
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --shadow-soft: 0 8px 32px rgba(31, 38, 135, 0.37);
            --shadow-strong: 0 15px 35px rgba(0, 0, 0, 0.1);
            --border-radius: 16px;
            --border-radius-large: 24px;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-attachment: fixed;
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
        }
        
        /* Floating Background Elements */
        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .shape {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
        }
        
        .shape:nth-child(1) { width: 120px; height: 120px; top: 10%; left: 5%; animation-delay: 0s; }
        .shape:nth-child(2) { width: 80px; height: 80px; top: 70%; left: 85%; animation-delay: 2s; }
        .shape:nth-child(3) { width: 60px; height: 60px; top: 30%; left: 70%; animation-delay: 4s; }
        .shape:nth-child(4) { width: 100px; height: 100px; top: 80%; left: 10%; animation-delay: 6s; }
        .shape:nth-child(5) { width: 40px; height: 40px; top: 50%; left: 50%; animation-delay: 1s; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg) scale(1); }
            33% { transform: translateY(-30px) rotate(120deg) scale(1.1); }
            66% { transform: translateY(-10px) rotate(240deg) scale(0.9); }
        }
        
        /* Header */
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-large);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-soft);
            position: relative;
            z-index: 10;
            animation: slideDown 0.8s ease-out;
            text-align: center;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .header h1 {
            font-size: 2.2em;
            margin-bottom: 8px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }
        
        .header p {
            color: var(--text-secondary);
            font-size: 1em;
            font-weight: 500;
        }
        
        .help-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-soft);
        }
        
        .help-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.4);
        }
        
        /* Enhanced Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .dashboard-card {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow-soft);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10;
        }
        
        .dashboard-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .dashboard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }
        
        .dashboard-card:hover::before {
            left: 100%;
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 12px;
        }
        
        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
            background: var(--primary-gradient);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .card-title {
            font-size: 1.1em;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .card-value {
            font-size: 2.8em;
            font-weight: 800;
            margin-bottom: 8px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .card-subtitle {
            color: var(--text-secondary);
            font-size: 0.9em;
            margin-bottom: 15px;
        }
        
        /* Progress Circles */
        .progress-circle {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 15px auto;
        }
        
        .progress-circle svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }
        
        .progress-circle-bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.3);
            stroke-width: 8;
        }
        
        .progress-circle-fill {
            fill: none;
            stroke: url(#gradient1);
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease;
        }
        
        .progress-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2em;
            font-weight: bold;
            color: var(--text-primary);
        }
        
        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 25px;
            position: relative;
            z-index: 10;
        }
        
        .content-area {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* Enhanced Subject Cards */
        .subjects-section {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-large);
            padding: 30px;
            box-shadow: var(--shadow-soft);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 1.4em;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .add-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }
        
        .subject-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: slideUp 0.6s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .subject-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-strong);
        }
        
        .subject-card::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-gradient);
        }
        
        .subject-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .subject-name {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }
        
        .subject-teacher {
            color: var(--text-secondary);
            font-size: 0.9em;
        }
        
        .subject-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        
        .stat-value {
            font-size: 1.2em;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .stat-label {
            font-size: 0.8em;
            color: var(--text-secondary);
            margin-top: 2px;
        }
        
        /* Enhanced Timer Section */
        .timer-section {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-large);
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow-soft);
        }
        
        .timer-display {
            font-size: 3em;
            font-weight: bold;
            color: var(--text-primary);
            margin: 25px 0;
            font-family: 'Courier New', monospace;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .subject-select {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            font-size: 1em;
            margin-bottom: 20px;
            transition: border-color 0.3s ease;
        }
        
        .subject-select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .timer-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 80px;
        }
        
        .timer-btn.start { 
            background: var(--success-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(17, 153, 142, 0.4);
        }
        
        .timer-btn.pause { 
            background: var(--warning-gradient);
            color: var(--text-primary);
            box-shadow: 0 4px 15px rgba(248, 181, 0, 0.4);
        }
        
        .timer-btn.stop { 
            background: var(--secondary-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.4);
        }
        
        .timer-btn:hover {
            transform: translateY(-2px);
        }
        
        /* Enhanced Goals Section */
        .goals-section {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-large);
            padding: 25px;
            box-shadow: var(--shadow-soft);
        }
        
        .goal-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .goal-name {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .goal-percentage {
            font-weight: 700;
            font-size: 1.1em;
            color: #667eea;
        }
        
        .goal-progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 0.9em;
            color: var(--text-secondary);
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 4px;
            background: var(--success-gradient);
            transition: width 0.8s ease;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                -45deg,
                rgba(255, 255, 255, 0.2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, 0.2) 50%,
                rgba(255, 255, 255, 0.2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 50px 50px;
            animation: move 2s linear infinite;
        }
        
        @keyframes move {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }
        
        /* Enhanced Leaderboard */
        .leaderboard {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-large);
            padding: 25px;
            box-shadow: var(--shadow-soft);
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .leaderboard-item.current-user {
            background: rgba(102, 126, 234, 0.2);
            border: 2px solid rgba(102, 126, 234, 0.4);
        }
        
        .leaderboard-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }
        
        .rank-badge {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-left: 15px;
            font-size: 1.1em;
        }
        
        .rank-1 { background: linear-gradient(135deg, #ffd700, #ffed4e); color: #b45309; }
        .rank-2 { background: linear-gradient(135deg, #c0c0c0, #e5e7eb); color: #374151; }
        .rank-3 { background: linear-gradient(135deg, #cd7f32, #f59e0b); color: #92400e; }
        .rank-other { background: rgba(255, 255, 255, 0.3); color: var(--text-primary); }
        
        .user-info {
            flex-grow: 1;
        }
        
        .user-name {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .user-hours {
            font-size: 0.9em;
            color: var(--text-secondary);
        }
        
        .user-score {
            font-size: 1.2em;
            font-weight: 700;
            color: #667eea;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            margin: 3% auto;
            padding: 35px;
            border-radius: var(--border-radius-large);
            width: 95%;
            max-width: 500px;
            box-shadow: var(--shadow-strong);
            position: relative;
            animation: scaleIn 0.3s ease;
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .close {
            position: absolute;
            top: 15px;
            left: 20px;
            color: var(--text-secondary);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .close:hover {
            color: #667eea;
        }
        
        .modal h2 {
            color: var(--text-primary);
            margin-bottom: 25px;
            font-size: 1.5em;
            font-weight: 700;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 600;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            font-size: 1em;
            color: var(--text-primary);
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .form-group input::placeholder {
            color: var(--text-secondary);
        }
        
        .submit-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }
        
        /* Animations */
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }
        
        .motivational-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-gradient);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            z-index: 3000;
            animation: slideInRight 0.5s ease, fadeOut 0.5s ease 3.5s forwards;
            box-shadow: var(--shadow-strong);
            font-weight: 600;
            backdrop-filter: blur(10px);
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100%); }
        }
        
        /* Mobile Responsiveness */
        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: -1;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 20px 15px;
                margin-bottom: 15px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .help-btn {
                top: 15px;
                left: 15px;
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                margin-bottom: 20px;
            }
            
            .dashboard-card {
                padding: 20px 15px;
            }
            
            .card-value {
                font-size: 2.2em;
            }
            
            .card-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .progress-circle {
                width: 60px;
                height: 60px;
            }
            
            .subjects-section,
            .timer-section,
            .goals-section,
            .leaderboard {
                padding: 20px;
            }
            
            .section-title {
                font-size: 1.2em;
            }
            
            .timer-display {
                font-size: 2.2em;
                margin: 20px 0;
            }
            
            .timer-controls {
                gap: 8px;
            }
            
            .timer-btn {
                padding: 10px 16px;
                font-size: 0.85em;
                min-width: 70px;
            }
            
            .subject-stats {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
            
            .modal-content {
                margin: 5% auto;
                padding: 25px 20px;
                width: 95%;
            }
            
            .leaderboard-item {
                padding: 12px;
            }
            
            .rank-badge {
                width: 30px;
                height: 30px;
                margin-left: 10px;
                font-size: 0.9em;
            }
        }
        
        @media (max-width: 480px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .timer-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .timer-btn {
                width: 100%;
                max-width: 200px;
            }
            
            .subject-stats {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .goal-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <div class="container">
        <header class="header">
            <button class="help-btn" onclick="showHelp()" title="المساعدة">❓</button>
            <h1>🎓 منظم الدراسة التونسي</h1>
            <p>نظم وقتك، لم نقاط، واتحدى صحابك في رحلة النجاح! 🚀</p>
        </header>

        <div class="dashboard-grid">
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">🏆</div>
                    <div>
                        <div class="card-title">النقاط الكل</div>
                    </div>
                </div>
                <div class="card-value" id="totalPoints">0</div>
                <div class="card-subtitle">نقطة محصلة</div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #11998e, #38ef7d);">⏰</div>
                    <div>
                        <div class="card-title">ساعات الدراسة</div>
                    </div>
                </div>
                <div class="card-value" id="totalHours">0.0</div>
                <div class="card-subtitle">ساعة هذا الأسبوع</div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">📚</div>
                    <div>
                        <div class="card-title">المواد</div>
                    </div>
                </div>
                <div class="card-value" id="subjectsCount">0</div>
                <div class="card-subtitle">مادة مسجلة</div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #ffeaa7, #fab1a0);">🔥</div>
                    <div>
                        <div class="card-title">السلسلة</div>
                    </div>
                </div>
                <div class="card-value" id="studyStreak">0</div>
                <div class="card-subtitle">يوم متتالي</div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #a8edea, #fed6e3);">📈</div>
                    <div>
                        <div class="card-title">تقدم الأسبوع</div>
                    </div>
                </div>
                <div class="progress-circle">
                    <svg viewBox="0 0 36 36">
                        <defs>
                            <linearGradient id="gradient1" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#667eea"/>
                                <stop offset="100%" style="stop-color:#764ba2"/>
                            </linearGradient>
                        </defs>
                        <path class="progress-circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                        <path class="progress-circle-fill" id="progressCircle" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" stroke-dasharray="0, 100"/>
                    </svg>
                    <div class="progress-percentage" id="weeklyProgress">0%</div>
                </div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #ff9a9e, #fecfef);">🎯</div>
                    <div>
                        <div class="card-title">الأهداف المحققة</div>
                    </div>
                </div>
                <div class="card-value" id="completedGoals">0/0</div>
                <div class="card-subtitle">هدف مكتمل</div>
            </div>
        </div>

        <div class="main-layout">
            <div class="content-area">
                <div class="subjects-section">
                    <div class="section-header">
                        <div class="section-title">📚 المواد الدراسية</div>
                        <button class="add-btn" onclick="openSubjectModal()">+ زيد مادة</button>
                    </div>
                    <div id="subjectsList"></div>
                </div>
            </div>

            <div class="sidebar">
                <div class="timer-section">
                    <h3 style="margin-bottom: 20px; color: var(--text-primary); font-weight: 700;">⏱️ عداد الوقت</h3>
                    <select id="currentSubject" class="subject-select">
                        <option value="">اختر المادة للدراسة</option>
                    </select>
                    <div class="timer-display" id="timerDisplay">00:00:00</div>
                    <div class="timer-controls">
                        <button class="timer-btn start" onclick="startTimer()">▶️ ابدأ</button>
                        <button class="timer-btn pause" onclick="pauseTimer()">⏸️ وقف</button>
                        <button class="timer-btn stop" onclick="stopTimer()">⏹️ اكمل</button>
                    </div>
                </div>

                <div class="goals-section">
                    <div class="section-header">
                        <div class="section-title">🎯 أهداف الأسبوع</div>
                        <button class="add-btn" onclick="openObjectiveModal()">+ زيد هدف</button>
                    </div>
                    <div id="objectivesList"></div>
                </div>

                <div class="leaderboard">
                    <div class="section-header">
                        <div class="section-title">🏆 لوحة المتصدرين</div>
                        <button class="add-btn" onclick="openFriendModal()">+ زيد صاحب</button>
                    </div>
                    <div id="friendsList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Subject Modal -->
    <div id="subjectModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSubjectModal()">&times;</span>
            <h2>📚 زيد مادة جديدة</h2>
            <form id="subjectForm">
                <div class="form-group">
                    <label>اسم المادة:</label>
                    <input type="text" id="subjectName" placeholder="مثال: الرياضيات" required>
                </div>
                <div class="form-group">
                    <label>الأستاذ:</label>
                    <input type="text" id="teacherName" placeholder="اسم الأستاذ">
                </div>
                <div class="form-group">
                    <label>عدد الحصص في الأسبوع:</label>
                    <select id="weeklyLessons" required>
                        <option value="">اختر عدد الحصص</option>
                        <option value="1">حصة وحدة</option>
                        <option value="2">حصتين</option>
                        <option value="3">3 حصص</option>
                        <option value="4">4 حصص</option>
                        <option value="5">5 حصص</option>
                        <option value="6">6 حصص</option>
                        <option value="7">7 حصص</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>هدف الدراسة الأسبوعي (ساعات):</label>
                    <input type="number" id="weeklyTarget" min="0.5" max="50" step="0.5" placeholder="مثال: 5">
                </div>
                <button type="submit" class="submit-btn">زيد المادة</button>
            </form>
        </div>
    </div>

    <!-- Objective Modal -->
    <div id="objectiveModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeObjectiveModal()">&times;</span>
            <h2>🎯 زيد هدف جديد</h2>
            <form id="objectiveForm">
                <div class="form-group">
                    <label>اسم الهدف:</label>
                    <input type="text" id="objectiveName" placeholder="مثال: ادرس 15 ساعة هذا الأسبوع" required>
                </div>
                <div class="form-group">
                    <label>عدد الساعات المطلوبة:</label>
                    <input type="number" id="targetHours" min="1" max="100" step="0.5" required>
                </div>
                <div class="form-group">
                    <label>نوع الهدف:</label>
                    <select id="objectiveType">
                        <option value="weekly">أسبوعي</option>
                        <option value="daily">يومي</option>
                        <option value="monthly">شهري</option>
                    </select>
                </div>
                <button type="submit" class="submit-btn">زيد الهدف</button>
            </form>
        </div>
    </div>

    <!-- Friend Modal -->
    <div id="friendModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeFriendModal()">&times;</span>
            <h2>👥 زيد صاحب للتحدي</h2>
            <form id="friendForm">
                <div class="form-group">
                    <label>اسم الصاحب:</label>
                    <input type="text" id="friendName" placeholder="اسم صاحبك" required>
                </div>
                <div class="form-group">
                    <label>ساعات الدراسة (هذا الأسبوع):</label>
                    <input type="number" id="friendHours" min="0" max="168" step="0.1" placeholder="0.0" required>
                </div>
                <div class="form-group">
                    <label>المستوى الأكاديمي:</label>
                    <select id="friendLevel">
                        <option value="same">نفس المستوى</option>
                        <option value="higher">مستوى أعلى</option>
                        <option value="lower">مستوى أقل</option>
                    </select>
                </div>
                <button type="submit" class="submit-btn">زيد الصاحب</button>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let subjects = [];
        let objectives = [];
        let friends = [];
        let timer = { hours: 0, minutes: 0, seconds: 0 };
        let timerInterval = null;
        let isTimerRunning = false;
        let totalStudyTime = 0;
        let totalPoints = 0;
        let studyStreak = 0;

        // Initialize app
        function initApp() {
            loadData();
            updateDashboard();
            renderSubjects();
            renderObjectives();
            renderFriends();
            updateSubjectSelect();
            updateStreak();
        }

        // Enhanced data management
        function saveData() {
            const data = {
                subjects,
                objectives,
                friends,
                totalStudyTime,
                totalPoints,
                studyStreak,
                lastSaveDate: new Date().toISOString()
            };
            // In a real app, this would save to localStorage or a server
            console.log('Data saved:', data);
        }

        function loadData() {
            // Initialize with sample data if empty
            if (subjects.length === 0) {
                subjects = [
                    { 
                        id: 1, 
                        name: 'الرياضيات', 
                        teacher: 'أستاذ أحمد', 
                        lessons: 4, 
                        studyTime: 8.5,
                        weeklyTarget: 10,
                        lastStudied: new Date().toISOString()
                    },
                    { 
                        id: 2, 
                        name: 'الفيزياء', 
                        teacher: 'أستاذة فاطمة', 
                        lessons: 3, 
                        studyTime: 6.2,
                        weeklyTarget: 8,
                        lastStudied: new Date().toISOString()
                    },
                    { 
                        id: 3, 
                        name: 'العربية', 
                        teacher: 'أستاذ محمد', 
                        lessons: 5, 
                        studyTime: 4.8,
                        weeklyTarget: 6,
                        lastStudied: new Date().toISOString()
                    }
                ];
                objectives = [
                    { 
                        id: 1, 
                        name: 'ادرس 25 ساعة هذا الأسبوع', 
                        target: 25, 
                        current: 19.5,
                        type: 'weekly',
                        createdDate: new Date().toISOString()
                    },
                    { 
                        id: 2, 
                        name: 'راجع الرياضيات 3 ساعات يومياً', 
                        target: 3, 
                        current: 2.1,
                        type: 'daily',
                        createdDate: new Date().toISOString()
                    }
                ];
                friends = [
                    { id: 1, name: 'أحمد', hours: 22.8, level: 'same' },
                    { id: 2, name: 'فاطمة', hours: 31.5, level: 'higher' },
                    { id: 3, name: 'محمد', hours: 18.2, level: 'same' },
                    { id: 4, name: 'سارة', hours: 27.9, level: 'higher' },
                    { id: 5, name: 'يوسف', hours: 15.6, level: 'lower' }
                ];
                totalStudyTime = 19.5;
                totalPoints = 195;
                studyStreak = 5;
            }
        }

        // Enhanced dashboard updates
        function updateDashboard() {
            // Update total points
            document.getElementById('totalPoints').textContent = totalPoints.toLocaleString();
            
            // Update total hours
            document.getElementById('totalHours').textContent = totalStudyTime.toFixed(1);
            
            // Update subjects count
            document.getElementById('subjectsCount').textContent = subjects.length;
            
            // Update study streak
            document.getElementById('studyStreak').textContent = studyStreak;
            
            // Calculate and update weekly progress
            const totalWeeklyTarget = objectives
                .filter(obj => obj.type === 'weekly')
                .reduce((sum, obj) => sum + obj.target, 0);
            
            const weeklyProgress = totalWeeklyTarget > 0 
                ? Math.min((totalStudyTime / totalWeeklyTarget) * 100, 100) 
                : 0;
            
            document.getElementById('weeklyProgress').textContent = `${Math.round(weeklyProgress)}%`;
            
            // Update progress circle
            const circle = document.getElementById('progressCircle');
            const circumference = 2 * Math.PI * 15.9155;
            const offset = circumference - (weeklyProgress / 100) * circumference;
            circle.style.strokeDasharray = `${circumference}, ${circumference}`;
            circle.style.strokeDashoffset = offset;
            
            // Update completed goals
            const completedGoals = objectives.filter(obj => obj.current >= obj.target).length;
            document.getElementById('completedGoals').textContent = `${completedGoals}/${objectives.length}`;
        }

        // Enhanced subject functions
        function openSubjectModal() {
            document.getElementById('subjectModal').style.display = 'block';
        }

        function closeSubjectModal() {
            document.getElementById('subjectModal').style.display = 'none';
            document.getElementById('subjectForm').reset();
        }

        document.getElementById('subjectForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const subject = {
                id: Date.now(),
                name: document.getElementById('subjectName').value,
                teacher: document.getElementById('teacherName').value || 'غير محدد',
                lessons: parseInt(document.getElementById('weeklyLessons').value),
                studyTime: 0,
                weeklyTarget: parseFloat(document.getElementById('weeklyTarget').value) || 0,
                lastStudied: null
            };
            
            subjects.push(subject);
            renderSubjects();
            updateSubjectSelect();
            updateDashboard();
            closeSubjectModal();
            saveData();
            
            showNotification('✅ تمت إضافة المادة بنجاح!', 'success');
        });

        function renderSubjects() {
            const container = document.getElementById('subjectsList');
            
            if (subjects.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <div style="font-size: 3em; margin-bottom: 15px;">📚</div>
                        <div style="font-size: 1.2em; margin-bottom: 10px;">لا توجد مواد مضافة بعد</div>
                        <div>اضغط على "زيد مادة" لبدء التنظيم</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = subjects.map(subject => {
                const progressPercentage = subject.weeklyTarget > 0 
                    ? Math.min((subject.studyTime / subject.weeklyTarget) * 100, 100) 
                    : 0;
                
                const progressColor = progressPercentage >= 100 
                    ? 'var(--success-gradient)' 
                    : progressPercentage >= 75 
                    ? 'var(--warning-gradient)' 
                    : 'var(--primary-gradient)';
                
                return `
                    <div class="subject-card" onclick="viewSubjectDetails(${subject.id})">
                        <div class="subject-header">
                            <div>
                                <div class="subject-name">${subject.name}</div>
                                <div class="subject-teacher">👨‍🏫 ${subject.teacher}</div>
                            </div>
                            <div style="text-align: left; font-size: 1.5em;">
                                ${progressPercentage >= 100 ? '🏆' : progressPercentage >= 75 ? '⭐' : '📖'}
                            </div>
                        </div>
                        
                        ${subject.weeklyTarget > 0 ? `
                            <div style="margin: 15px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-size: 0.9em; color: var(--text-secondary);">التقدم الأسبوعي</span>
                                    <span style="font-weight: 700; color: ${progressPercentage >= 75 ? '#11998e' : '#667eea'};">
                                        ${progressPercentage.toFixed(1)}%
                                    </span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${progressPercentage}%; background: ${progressColor};"></div>
                                </div>
                                <div style="font-size: 0.8em; color: var(--text-secondary); margin-top: 5px;">
                                    ${subject.studyTime.toFixed(1)} / ${subject.weeklyTarget} ساعة
                                </div>
                            </div>
                        ` : ''}
                        
                        <div class="subject-stats">
                            <div class="stat-item">
                                <div class="stat-value">${subject.lessons}</div>
                                <div class="stat-label">حصة/أسبوع</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${subject.studyTime.toFixed(1)}</div>
                                <div class="stat-label">ساعة مدروسة</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${Math.floor(subject.studyTime * 10)}</div>
                                <div class="stat-label">نقطة</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function viewSubjectDetails(id) {
            const subject = subjects.find(s => s.id === id);
            const lastStudied = subject.lastStudied 
                ? new Date(subject.lastStudied).toLocaleDateString('ar-TN')
                : 'لم يتم الدراسة بعد';
            
            const details = `
                📚 تفاصيل مادة ${subject.name}
                
                👨‍🏫 الأستاذ: ${subject.teacher}
                📅 عدد الحصص: ${subject.lessons} في الأسبوع
                ⏰ وقت الدراسة: ${subject.studyTime.toFixed(1)} ساعة
                🎯 الهدف الأسبوعي: ${subject.weeklyTarget || 'غير محدد'} ساعة
                🏆 النقاط المحصلة: ${Math.floor(subject.studyTime * 10)} نقطة
                📆 آخر دراسة: ${lastStudied}
            `;
            
            alert(details);
        }

        // Enhanced timer functions
        function updateSubjectSelect() {
            const select = document.getElementById('currentSubject');
            select.innerHTML = '<option value="">اختر المادة للدراسة</option>' + 
                subjects.map(s => `<option value="${s.id}">${s.name}</option>`).join('');
        }

        function startTimer() {
            const subjectId = document.getElementById('currentSubject').value;
            if (!subjectId) {
                showNotification('⚠️ اختر مادة أولاً!', 'warning');
                return;
            }
            
            if (!isTimerRunning) {
                isTimerRunning = true;
                timerInterval = setInterval(updateTimer, 1000);
                document.querySelector('.timer-section').classList.add('pulse-animation');
                playSound('start');
                showNotification('▶️ بدأ العداد! بالتوفيق!', 'success');
            }
        }

        function pauseTimer() {
            if (isTimerRunning) {
                isTimerRunning = false;
                clearInterval(timerInterval);
                document.querySelector('.timer-section').classList.remove('pulse-animation');
                playSound('pause');
                showNotification('⏸️ تم إيقاف العداد مؤقتاً', 'info');
            }
        }

        function stopTimer() {
            const subjectId = document.getElementById('currentSubject').value;
            if (subjectId && (timer.hours > 0 || timer.minutes > 0 || timer.seconds > 0)) {
                const totalMinutes = timer.hours * 60 + timer.minutes + timer.seconds / 60;
                const hoursStudied = totalMinutes / 60;
                
                // Update subject study time
                const subject = subjects.find(s => s.id == subjectId);
                if (subject) {
                    subject.studyTime += hoursStudied;
                    subject.lastStudied = new Date().toISOString();
                }
                
                // Update totals
                totalStudyTime += hoursStudied;
                totalPoints += Math.floor(hoursStudied * 10);
                
                // Update objectives
                objectives.forEach(obj => {
                    if (obj.type === 'weekly' || obj.type === 'daily') {
                        obj.current = Math.min(obj.current + hoursStudied, obj.target);
                    }
                });
                
                // Update streak
                updateStreak();
                
                // Show celebration
                showCelebration(hoursStudied, subject.name);
                
                renderSubjects();
                renderObjectives();
                updateDashboard();
                saveData();
                
                playSound('achievement');
            } else if (!subjectId) {
                showNotification('⚠️ اختر مادة أولاً!', 'warning');
            } else {
                playSound('stop');
            }
            
            // Reset timer
            timer = { hours: 0, minutes: 0, seconds: 0 };
            updateTimerDisplay();
            pauseTimer();
        }

        function updateTimer() {
            timer.seconds++;
            if (timer.seconds >= 60) {
                timer.seconds = 0;
                timer.minutes++;
                if (timer.minutes >= 60) {
                    timer.minutes = 0;
                    timer.hours++;
                }
            }
            updateTimerDisplay();
            
            // Show motivational messages at certain intervals
            if (timer.minutes === 0 && timer.seconds === 0 && timer.hours > 0) {
                showMotivationalMessage();
            }
        }

        function updateTimerDisplay() {
            const display = document.getElementById('timerDisplay');
            display.textContent = 
                `${timer.hours.toString().padStart(2, '0')}:${timer.minutes.toString().padStart(2, '0')}:${timer.seconds.toString().padStart(2, '0')}`;
        }

        function showCelebration(hours, subjectName) {
            const points = Math.floor(hours * 10);
            const message = `
                🎉 أحسنت! تمت الدراسة بنجاح
                
                📚 المادة: ${subjectName}
                ⏰ المدة: ${hours.toFixed(2)} ساعة
                🏆 النقاط: ${points} نقطة
                
                واصل هذا المجهود الرائع! 💪
            `;
            alert(message);
        }

        // Enhanced objectives functions
        function openObjectiveModal() {
            document.getElementById('objectiveModal').style.display = 'block';
        }

        function closeObjectiveModal() {
            document.getElementById('objectiveModal').style.display = 'none';
            document.getElementById('objectiveForm').reset();
        }

        document.getElementById('objectiveForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const objective = {
                id: Date.now(),
                name: document.getElementById('objectiveName').value,
                target: parseFloat(document.getElementById('targetHours').value),
                current: 0,
                type: document.getElementById('objectiveType').value,
                createdDate: new Date().toISOString()
            };
            
            objectives.push(objective);
            renderObjectives();
            updateDashboard();
            closeObjectiveModal();
            saveData();
            
            showNotification('🎯 تمت إضافة الهدف بنجاح!', 'success');
        });

        function renderObjectives() {
            const container = document.getElementById('objectivesList');
            
            if (objectives.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: var(--text-secondary);">
                        <div style="font-size: 2.5em; margin-bottom: 15px;">🎯</div>
                        <div style="font-size: 1.1em; margin-bottom: 8px;">لا توجد أهداف محددة</div>
                        <div style="font-size: 0.9em;">حدد أهدافك لتحفيز نفسك أكثر</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = objectives.map(obj => {
                const progress = Math.min((obj.current / obj.target) * 100, 100);
                const isCompleted = progress >= 100;
                const typeIcon = obj.type === 'daily' ? '📅' : obj.type === 'weekly' ? '📊' : '🗓️';
                
                return `
                    <div class="goal-item ${isCompleted ? 'completed' : ''}" style="${isCompleted ? 'border: 2px solid #11998e; background: rgba(17, 153, 142, 0.1);' : ''}">
                        <div class="goal-header">
                            <div class="goal-name">
                                ${typeIcon} ${obj.name}
                                ${isCompleted ? ' ✅' : ''}
                            </div>
                            <div class="goal-percentage">${progress.toFixed(1)}%</div>
                        </div>
                        <div class="goal-progress">
                            <span>${obj.current.toFixed(1)} ساعة</span>
                            <span>${obj.target} ساعة</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%; background: ${isCompleted ? 'var(--success-gradient)' : 'var(--primary-gradient)'};">
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Enhanced friends functions
        function openFriendModal() {
            document.getElementById('friendModal').style.display = 'block';
        }

        function closeFriendModal() {
            document.getElementById('friendModal').style.display = 'none';
            document.getElementById('friendForm').reset();
        }

        document.getElementById('friendForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const friend = {
                id: Date.now(),
                name: document.getElementById('friendName').value,
                hours: parseFloat(document.getElementById('friendHours').value),
                level: document.getElementById('friendLevel').value
            };
            
            friends.push(friend);
            renderFriends();
            closeFriendModal();
            saveData();
            
            showNotification('👥 تمت إضافة الصديق بنجاح!', 'success');
        });

        function renderFriends() {
            const container = document.getElementById('friendsList');
            const currentUser = { name: 'أنت', hours: totalStudyTime, level: 'current' };
            const sortedFriends = [...friends, currentUser]
                .sort((a, b) => b.hours - a.hours);
            
            if (friends.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: var(--text-secondary);">
                        <div style="font-size: 2.5em; margin-bottom: 15px;">👥</div>
                        <div style="font-size: 1.1em; margin-bottom: 8px;">لا يوجد أصدقاء في التحدي</div>
                        <div style="font-size: 0.9em;">أضف أصدقائك لتحدي أكثر إثارة</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = sortedFriends.map((friend, index) => {
                const isCurrentUser = friend.name === 'أنت';
                const rankClass = index === 0 ? 'rank-1' : index === 1 ? 'rank-2' : index === 2 ? 'rank-3' : 'rank-other';
                const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : `${index + 1}`;
                const levelIcon = friend.level === 'higher' ? '⬆️' : friend.level === 'lower' ? '⬇️' : '🔄';
                
                return `
                    <div class="leaderboard-item ${isCurrentUser ? 'current-user' : ''}" onclick="${!isCurrentUser ? `updateFriendHours(${friend.id})` : ''}">
                        <div class="rank-badge ${rankClass}">${medal}</div>
                        <div class="user-info">
                            <div class="user-name">
                                ${friend.name} ${isCurrentUser ? '(أنت)' : ''}
                                ${!isCurrentUser ? levelIcon : ''}
                            </div>
                            <div class="user-hours">
                                ${Math.floor(friend.hours * 10)} نقطة • هذا الأسبوع
                            </div>
                        </div>
                        <div class="user-score">${friend.hours.toFixed(1)}h</div>
                    </div>
                `;
            }).join('');
        }

        function updateFriendHours(friendId) {
            const friend = friends.find(f => f.id === friendId);
            if (friend) {
                const newHours = prompt(`تحديث ساعات ${friend.name}:`, friend.hours);
                if (newHours !== null && !isNaN(newHours) && newHours >= 0) {
                    friend.hours = parseFloat(newHours);
                    renderFriends();
                    saveData();
                    showNotification(`✅ تم تحديث ساعات ${friend.name}`, 'success');
                }
            }
        }

        // Enhanced streak management
        function updateStreak() {
            const today = new Date().toDateString();
            const lastStudyDate = localStorage.getItem('lastStudyDate') || '';
            const currentStreak = parseInt(localStorage.getItem('studyStreak') || '0');
            
            if (lastStudyDate === today) {
                studyStreak = currentStreak;
            } else {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                
                if (lastStudyDate === yesterday.toDateString()) {
                    studyStreak = currentStreak + 1;
                } else if (lastStudyDate !== '') {
                    studyStreak = 1;
                } else {
                    studyStreak = 1;
                }
                
                localStorage.setItem('lastStudyDate', today);
                localStorage.setItem('studyStreak', studyStreak.toString());
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            // Remove existing notifications
            document.querySelectorAll('.notification').forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 12px;
                color: white;
                font-weight: 600;
                z-index: 3000;
                animation: slideInRight 0.4s ease, fadeOut 0.4s ease 3s forwards;
                box-shadow: var(--shadow-strong);
                backdrop-filter: blur(10px);
                max-width: 350px;
                word-wrap: break-word;
            `;
            
            // Set background based on type
            switch(type) {
                case 'success':
                    notification.style.background = 'var(--success-gradient)';
                    break;
                case 'warning':
                    notification.style.background = 'var(--warning-gradient)';
                    notification.style.color = 'var(--text-primary)';
                    break;
                case 'error':
                    notification.style.background = 'var(--secondary-gradient)';
                    break;
                default:
                    notification.style.background = 'var(--primary-gradient)';
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3500);
        }

        // Enhanced motivational messages
        function showMotivationalMessage() {
            const messages = [
                "🌟 برافو عليك! واصل هكذا!",
                "💪 إنت في الطريق الصحيح!",
                "🎯 كل دقيقة استثمار في مستقبلك!",
                "🔑 الصبر والمثابرة مفتاح النجاح!",
                "🌙 حلمك قريب، لا تستسلم!",
                "⛰️ كل ساعة دراسة خطوة للقمة!",
                "🚀 أنت أقوى من أي تحدي!",
                "✨ العبقرية 1% إلهام و99% عمل جاد!",
                "🎓 المعرفة قوة، واصل البناء!",
                "🏆 الفائزون لا يتوقفون أبداً!"
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            showNotification(randomMessage, 'success');
        }

        // Enhanced sound system
        function playSound(type) {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                let frequency = 440;
                let duration = 0.3;
                
                switch(type) {
                    case 'start': 
                        frequency = 523.25; // C note
                        duration = 0.4;
                        break;
                    case 'pause': 
                        frequency = 392.00; // G note
                        duration = 0.2;
                        break;
                    case 'stop': 
                        frequency = 659.25; // E note
                        duration = 0.3;
                        break;
                    case 'achievement': 
                        // Play a chord for achievement
                        playChord(audioContext, [523.25, 659.25, 783.99], 0.8);
                        return;
                }
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            } catch (error) {
                console.log('Audio not supported');
            }
        }

        function playChord(audioContext, frequencies, duration) {
            frequencies.forEach((freq, index) => {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = freq;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.6);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.6);
                }, index * 100);
            });
        }

        // Help system
        function showHelp() {
            const helpText = `
🎓 مرحباً بك في منظم الدراسة التونسي!

⌨️ اختصارات المفاتيح:
• Ctrl+N: زيد مادة جديدة  
• Ctrl+T: ابدأ/وقف العداد
• Ctrl+R: اكمل الجلسة وارجع للصفر
• Esc: أغلق النوافذ

📊 نظام النقاط:
• كل ساعة دراسة = 10 نقاط
• ادرس كل يوم باش تحافظ على السلسلة 🔥
• حط أهداف واقعية وتابع تقدمك

👥 التحدي مع الأصدقاء:
• زيد أصدقائك وشوف مين يدرس أكثر
• حدث ساعاتهم باستمرار للمنافسة

🎯 نصائح للنجاح:
• نظم وقتك وخطط مسبقاً
• خذ راحة كل ساعة
• راجع أهدافك أسبوعياً
• تحدى نفسك باستمرار

💡 للمساعدة أو الاقتراحات، لا تتردد في التواصل!
            `;
            alert(helpText);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
            }
            
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'n':
                        e.preventDefault();
                        openSubjectModal();
                        break;
                    case 't':
                        e.preventDefault();
                        if (isTimerRunning) pauseTimer();
                        else startTimer();
                        break;
                    case 'r':
                        e.preventDefault();
                        stopTimer();
                        break;
                }
            }
        });

        // Modal close functionality
        window.onclick = function(event) {
            const modals = ['subjectModal', 'objectiveModal', 'friendModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Auto-save functionality
        setInterval(saveData, 30000); // Save every 30 seconds

        // Daily reset for daily objectives
        function checkDailyReset() {
            const lastReset = localStorage.getItem('lastDailyReset');
            const today = new Date().toDateString();
            
            if (lastReset !== today) {
                objectives.forEach(obj => {
                    if (obj.type === 'daily') {
                        obj.current = 0;
                    }
                });
                localStorage.setItem('lastDailyReset', today);
                renderObjectives();
                updateDashboard();
            }
        }

        // Weekly reset for weekly objectives
        function checkWeeklyReset() {
            const lastReset = localStorage.getItem('lastWeeklyReset');
            const today = new Date();
            const weekStart = new Date(today.setDate(today.getDate() - today.getDay())).toDateString();
            
            if (lastReset !== weekStart) {
                objectives.forEach(obj => {
                    if (obj.type === 'weekly') {
                        obj.current = 0;
                    }
                });
                subjects.forEach(subject => {
                    subject.studyTime = 0;
                });
                totalStudyTime = 0;
                localStorage.setItem('lastWeeklyReset', weekStart);
                renderSubjects();
                renderObjectives();
                updateDashboard();
            }
        }

        // Performance monitoring
        function logPerformance() {
            const stats = {
                subjects: subjects.length,
                totalStudyTime: totalStudyTime,
                totalPoints: totalPoints,
                streak: studyStreak,
                objectives: objectives.length,
                friends: friends.length,
                timestamp: new Date().toISOString()
            };
            console.log('Performance Stats:', stats);
        }

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            checkDailyReset();
            checkWeeklyReset();
            
            // Show welcome message
            setTimeout(() => {
                showNotification('🎓 أهلاً بك في منظم الدراسة! ابدأ رحلة النجاح الآن', 'success');
            }, 1000);
            
            // Log performance every hour
            setInterval(logPerformance, 3600000);
        });

        // Service worker for offline functionality (if needed)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                // Register service worker for offline functionality
                console.log('App ready for offline usage');
            });
        }

        // Export data functionality
        function exportData() {
            const data = {
                subjects,
                objectives,
                friends,
                totalStudyTime,
                totalPoints,
                studyStreak,
                exportDate: new Date().toISOString(),
                version: '2.0'
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `study-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        // Import data functionality
        function importData(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.subjects && data.objectives) {
                            subjects = data.subjects;
                            objectives = data.objectives;
                            friends = data.friends || [];
                            totalStudyTime = data.totalStudyTime || 0;
                            totalPoints = data.totalPoints || 0;
                            studyStreak = data.studyStreak || 0;
                            
                            initApp();
                            showNotification('✅ تم استيراد البيانات بنجاح!', 'success');
                        }
                    } catch (error) {
                        showNotification('❌ خطأ في استيراد البيانات', 'error');
                    }
                };
                reader.readAsText(file);
            }
        }

        // Add export/import functionality to help menu
        const originalShowHelp = showHelp;
        showHelp = function() {
            const helpWithExport = `
${originalShowHelp.toString().match(/`([\s\S]*)`/)[1]}

💾 إدارة البيانات:
• تصدير البيانات: للنسخ الاحتياطي
• استيراد البيانات: لاستعادة النسخة الاحتياطية

📱 متوافق مع الجوال والكمبيوتر
🔄 حفظ تلقائي كل 30 ثانية
            `;
            
            if (confirm(helpWithExport + '\n\nهل تريد تصدير بياناتك الآن؟')) {
                exportData();
            }
        };

        console.log('🎓 Study Organizer App Loaded Successfully!');
        console.log('📱 Mobile optimized and ready to use');
        console.log('🚀 Enhanced dashboard with progress tracking');
    </script>
</body>
</html>